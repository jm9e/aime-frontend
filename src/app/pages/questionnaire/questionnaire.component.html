<section class="section">
  <div class="container">
    <div class="steps" *ngIf="!submitted">

      <div class="step-item" [ngClass]="{'is-active': stepComplete(1)}" (click)="goToStep(1)">
        <div class="step-marker">1</div>
        <div class="step-details">
          <p class="step-title" [ngClass]="{'is-selected': step === 1}">Metadata</p>
        </div>
      </div>
      <div class="step-item" [ngClass]="{'is-active': stepComplete(2)}" (click)="goToStep(2)">
        <div class="step-marker">2</div>
        <div class="step-details">
          <p class="step-title" [ngClass]="{'is-selected': step === 2}">Purpose</p>
        </div>
      </div>
      <div class="step-item" [ngClass]="{'is-active': stepComplete(3)}" (click)="goToStep(3)">
        <div class="step-marker">3</div>
        <div class="step-details">
          <p class="step-title" [ngClass]="{'is-selected': step === 3}">Data</p>
        </div>
      </div>
      <div class="step-item" [ngClass]="{'is-active': stepComplete(4)}" (click)="goToStep(4)">
        <div class="step-marker">4</div>
        <div class="step-details">
          <p class="step-title" [ngClass]="{'is-selected': step === 4}">Method</p>
        </div>
      </div>
      <div class="step-item" [ngClass]="{'is-active': stepComplete(5)}" (click)="goToStep(5)">
        <div class="step-marker">5</div>
        <div class="step-details">
          <p class="step-title" [ngClass]="{'is-selected': step === 5}">Reproducibility</p>
        </div>
      </div>
      <div class="step-item" [ngClass]="{'is-active': stepComplete(6)}" (click)="goToStep(6)">
        <div class="step-marker">6</div>
        <div class="step-details">
          <p class="step-title" [ngClass]="{'is-selected': step === 6}">Review & Submit</p>
        </div>
      </div>

      <div class="steps-content">

        <div class="step-content card" [ngClass]="{'is-active': step === 1}">
          <header class="card-header">
            <div class="card-header-title">
              <h2 class="title is-4">
                Metadata
              </h2>
            </div>
          </header>
          <div class="card-content">
            <div class="field is-horizontal">
              <div class="field-label is-normal">
                <label class="label">MD.1</label>
              </div>
              <div class="field-body">
                <div class="field">
                  <div class="control">
                    <input class="input" name="title" type="text" placeholder="Title" [(ngModel)]="questionnaire.title">
                  </div>
                  <p class="help has-text-left">Title of the AI</p>
                </div>
              </div>
            </div>
            <div class="field is-horizontal">
              <div class="field-label is-normal">
                <label class="label">MD.2</label>
              </div>
              <div class="field-body">
                <div class="field">
                  <div class="control">
                    <textarea class="input" name="description" placeholder="Description"
                              [(ngModel)]="questionnaire.description"></textarea>
                  </div>
                  <p class="help has-text-left">Short description of the AI</p>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="step-content card" [ngClass]="{'is-active': step === 2}">
          <header class="card-header">
            <div class="card-header-title">
              <h2 class="title is-4">
                Purpose
              </h2>
            </div>
          </header>
          <div class="card-content">

          </div>
        </div>

        <div class="step-content card" [ngClass]="{'is-active': step === 3}">
          <header class="card-header">
            <div class="card-header-title">
              <h2 class="title is-4">
                Data
              </h2>
            </div>
          </header>
          <div class="card-content has-text-centered">
            <div *ngFor="let dataset of questionnaire.datasets; let i = index;" class="dataset">
              <h2 class="title is-4">Dataset #{{i + 1}}</h2>
              <div class="has-text-right">
                <button class="button is-danger is-small" (click)="removeDataset(i)">
                  Remove
                </button>
              </div>
              <br>
              <div class="field is-horizontal">
                <div class="field-label is-normal">
                  <label class="label">D.3</label>
                </div>
                <div class="field-body">
                  <div class="field">
                    <div class="control">
                      <input class="input" name="title" type="text" placeholder="Real or synthetic?" [(ngModel)]="dataset.synthetic">
                    </div>
                    <p class="help has-text-left">Is the data real or simulated? If it is simulated, is the simulator publicly available and, if so, where?</p>
                  </div>
                </div>
              </div>
              <div class="field is-horizontal">
                <div class="field-label is-normal">
                  <label class="label">D.4</label>
                </div>
                <div class="field-body">
                  <div class="field">
                    <div class="control">
                      <textarea class="input" name="description" placeholder="Availability" [(ngModel)]="dataset.availability"></textarea>
                    </div>
                    <p class="help has-text-left">Is the data publicly available? If so, where?</p>
                  </div>
                </div>
              </div>
            </div>
            <div class="add-form">
              <button data-nav="next" class="button is-light" (click)="addDataset()">
                Add another dataset
              </button>
            </div>
          </div>
        </div>

        <div class="step-content card" [ngClass]="{'is-active': step === 4}">
          <header class="card-header">
            <div class="card-header-title">
              <h2 class="title is-4">
                Method
              </h2>
            </div>
          </header>
          <div class="card-content">

          </div>
        </div>

        <div class="step-content card" [ngClass]="{'is-active': step === 5}">
          <header class="card-header">
            <div class="card-header-title">
              <h2 class="title is-4">
                Reproducibility
              </h2>
            </div>
          </header>
          <div class="card-content">

          </div>
        </div>

        <div class="step-content card" [ngClass]="{'is-active': step === 6}">
          <header class="card-header">
            <div class="card-header-title">
              <h2 class="title is-4">
                Review & Submit
              </h2>
            </div>
          </header>
          <div class="card-content">
            <p>
              Review all answers carefully. You can edit everything later, but it will create another revision.
            </p>
            <p>
              If you want to correct something, either use the <span class="tag">Previous</span> button below,
              or click on the according step above.
            </p>
            <pre>{{representation()}}</pre>
          </div>
        </div>
      </div>

      <div class="steps-actions">
        <div class="steps-action">
          <button data-nav="previous" class="button is-normal" (click)="step = step - 1" *ngIf="step > 1">Previous</button>
        </div>
        <div class="steps-action">
          <button data-nav="next" class="button is-success" (click)="step = step + 1" *ngIf="step < 6"
                  [disabled]="!stepComplete(step)">Next
          </button>
          <button data-nav="next" class="button is-info" (click)="submitQuestionnaire()" *ngIf="step == 6"
                  [disabled]="!completeUntil(6)">Submit
          </button>
        </div>
      </div>

    </div>

    <div class="container" *ngIf="submitted">
      <div class="notification is-info" *ngIf="!password || !id">
        <span class="icon has-text-white">
          <i class="fa fa-spinner fa-spin"></i>
        </span>
        Your report is being created...
      </div>

      <article class="message" *ngIf="password && id">
        <header class="message-header">
          <p>
            Your AIMe report
          </p>
        </header>
        <div class="message-body">
          <p>
            Your report <code>https://aime-standard.org/report/{{id}}.pdf</code> has been generated.
          </p>
          <br>
          <p>
            View your report here:
            <a target="_blank" href="https://aime-standard.org/report/{{id}}.pdf">https://aime-standard.org/report/{{id}}.pdf</a>
          </p>
          <p>
            Edit your report here:
            <a target="_blank" href="https://aime-standard.org/questionnaire?id={{id}}&p={{password}}">https://aime-standard.org/questionnaire?id={{id}}&p={{password}}</a>
          </p>
          <p>
            These links have also been sent to you by email.
          </p>
          <br>
          <p>
            Thank you for using the AIMe Standard.
          </p>
        </div>
      </article>
    </div>
  </div>
</section>
